---
title: "Homework #3"
author: "Natalie Mayer"
format: html
editor: visual
---

```{r}
library(tidyverse)
library(here)
library(janitor)
library(lubridate)

ca_rights <- read_csv(here("data", "california.csv"))

# https://ca.water.usgs.gov/california-drought/california-drought-runoff.html
ca_runoff <- read_csv(here("data", "annual-california-runoff.csv"))
```

```{r}
# cleaning runoff data 
ca_runoff_clean <- ca_runoff %>%
  clean_names() %>%
  mutate(date = ymd(paste0(category, "-01-01"))) %>%
  mutate(year = year(date)) %>%
  select(year, annual_runoff)        

```

```{r}
ca_rights_agg <- ca_rights %>%
  clean_names() %>%
  select(priority_date, cfs) %>%
  mutate(date = mdy(priority_date)) %>%
  mutate(date = if_else(year(date) > 2023, date - years(100), date)) %>%
  mutate(year = year(date))%>%
  filter(year > 1924) %>%
  filter(year < 2000) %>%
  select(year, cfs) %>%
  group_by(year) %>%
  summarise(cfs = sum(cfs)) %>%
  ungroup() %>%
  arrange(year) %>% 
  mutate(agg_cfs = cumsum(cfs))
```

```{r}
ggplot(ca_rights_agg, aes(x = year, y = agg_cfs)) + 
  geom_col()
```

